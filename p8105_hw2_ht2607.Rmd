---
title: "p8105_hw2_ht2607"
output: github_document
---

## Question 1

```{r setup, include=FALSE}
library(tidyverse)
library(tidyr)
```

```{r}
month_df = 
  tibble(
    month_num = 1:12,
    month_abb = month.abb,
    month = month.name
  )

pols = 
  read_csv("./data/fivethirtyeight_datasets/pols-month.csv") |>
  separate(mon, into = c("year", "month_num", "day"), convert = TRUE) |>
  mutate(
    president = recode(prez_gop, "0" = "dem", "1" = "gop", "2" = "gop")) |>
  left_join(x = _, y = month_df) |> 
  select(year, month, everything(), -day, -starts_with("prez")) 

snp = 
  read_csv("./data/fivethirtyeight_datasets/snp.csv") |>
  separate(date, into = c("month", "day", "year"), convert = TRUE) |>
  arrange(year, month) |>
  mutate(month = month.name[month]) |>
  select(year, month, close) 

unemployment = 
  read_csv("./data/fivethirtyeight_datasets/unemployment.csv") |>
  rename(year = Year) |>
  pivot_longer(
    Jan:Dec, 
    names_to = "month_abb",
    values_to = "unemployment"
  ) |> 
  left_join(x = _, y = month_df) |> 
  select(year, month, unemployment)

data_538 = 
  left_join(pols, snp) |>
  left_join(x = _, y = unemployment)

str(data_538)
```

## Question 2

```{r}
library(readxl)
library(tidyverse)
mr_trash_df = read_excel("q2data/202309 Trash Wheel Collection Data.xlsx", sheet = "Mr. Trash Wheel") |> 
  janitor::clean_names() |> 
  drop_na(dumpster) |> 
  mutate(homes_powered = weight_tons*500/30)
```

```{r}
professor_trash_df = read_excel("q2data/202309 Trash Wheel Collection Data.xlsx", sheet = "Professor Trash Wheel") |> 
  janitor::clean_names() |> 
  drop_na(dumpster) |> 
  mutate(homes_powered = weight_tons*500/30)
```

```{r}
gwynnda_df= read_excel("q2data/202309 Trash Wheel Collection Data.xlsx", sheet = "Gwynnda Trash Wheel") |> 
  janitor::clean_names() |> 
  drop_na(dumpster) |> 
  mutate(homes_powered = weight_tons*500/30)
```

```{r}
mr_trash_df = 
  readxl::read_excel("q2data/202309 Trash Wheel Collection Data.xlsx", sheet = "Professor Trash Wheel") |>
  mutate(trash_wheel = "mr.trash")

professor_trash_df = 
  readxl::read_excel("q2data/202309 Trash Wheel Collection Data.xlsx", sheet = "Professor Trash Wheel") |>
  mutate(trash_wheel = "professor trash")

gwynnda_df = 
  readxl::read_excel("q2data/202309 Trash Wheel Collection Data.xlsx", sheet = "Gwynnda Trash Wheel") |>
  mutate(trash_wheel = "gwynnda")

trash_df_tidy = 
  bind_rows(mr_trash_df, professor_trash_df, gwynnda_df) |>
  janitor::clean_names()
```

```{r}
sum(trash_df_tidy[trash_df_tidy$trash_wheel == "professor trash",]$weight_tons)
```
```{r}
sum(trash_df_tidy[trash_df_tidy$trash_wheel == "gwynnda" & trash_df_tidy$year== 2021 & trash_df_tidy$month== "July",]$cigarette_butts, na.rm = T)
```

Write a paragraph about these data; you are encouraged to use inline R. Be sure to note the number of observations in the resulting dataset, and give examples of key variables. For available data, what was the total weight of trash collected by Professor Trash Wheel? What was the total number of cigarette butts collected by Gwynnda in July of 2021?

The total weight of trash collected by Professor Trash Wheel is  380.24.
The total number of cigarette butts collected by Gwynnda in July of 2021 is 380.24.

## Question 3

```{r}
mci_df = read_csv(file = "./data_mci/MCI_baseline.csv", skip = 1, na = ".") |>
  janitor::clean_names() |> 
  drop_na() |> 
  mutate(
   sex = 
      case_match(
        sex, 
        1 ~ "male", 
        0 ~ "female"),
   sex = as.factor(sex))

amyloid_df = read_csv(file = "./data_mci/mci_amyloid.csv", skip = 1, na = "NA") |>
  janitor::clean_names() |> 
  drop_na(time_2, time_4, time_6, time_8) |> 
mutate(
   study_id = as.numeric(study_id)) |> 
  rename(id = study_id)
 
amyloid_df_tidy = 
pivot_longer(
  amyloid_df,
    cols=c(time_2, time_4, time_6, time_8), 
    names_to = "time",
    values_to = "biomarker")

mci_df_tidy = 
 inner_join(mci_df, amyloid_df_tidy , by = "id") |> 
  janitor::clean_names() |> 
  filter(age_at_onset > current_age | is.na(age_at_onset))
```

The important steps when importing the dataset is to filter the dataset so only keep 
the necessary variable when combining the dataset from the import files. 
It is 

```{r}
nrow(mci_df_tidy)
mean(mci_df_tidy$current_age)

women_apoe_df= filter(mci_df_tidy, sex == "female")
table(women_apoe_df$apoe4)/ nrow(women_apoe_df)
```
There are 252 participants that were recruited. 
63 of them develop MCI (need to ask which vairble should look at).
The average baseline age is at 65.69 (double ckeck with this).
0.65625 is the proportion of women in the study are APOE4 carriers.

1. need to explain step by step (answer the question step by step) --> apply to all questions
2. pivot longer from basline (year 0)
3. last step is to combine mci and amy


```{r}

```

